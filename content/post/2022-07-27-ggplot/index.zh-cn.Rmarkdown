---
title: ggplot2ä¸­ä¸ç›´æ–¹å›¾çš„å†æ¬¡é‚‚é€…ğŸ˜‰
author: guoguo
date: '2022-07-27'
slug: index.zh-cn
categories:
  - æ•°æ®å¯è§†åŒ–
tags:
  - R
  - ggplot2
  - ggsci
lastmod: '2022-07-27T21:49:41+08:00'
keywords: []
description: ''
comment: yes
toc: no
autoCollapseToc: no
contentCopyright: "å¦‚éœ€è½¬è½½ï¼Œè¯·è”ç³»ä½œè€…ï¼Œè°¢è°¢"
reward: yes
mathjax: yes
---

<p style="text-indent:2em;font-size:;font-family:;">
ç›´æ–¹å›¾æ˜¯æˆ‘åœ¨å±•ç¤ºè¿ç»­æ€§å˜é‡æ•°æ®ä¸­æœ€å¸¸ç”¨çš„å¯è§†åŒ–æ–¹å¼ã€‚å®ƒç›´è§‚ï¼Œå¯ä»¥ä¸€çœ¼çœ‹å‡ºæ•°æ®çš„åˆ†å¸ƒæ–¹å¼ã€åˆ†å¸ƒåŒºé—´ã€æœ€å¤§å€¼ã€æœ€å°å€¼ï¼Œå¯ä»¥å±•ç¤ºå‡ºæœ€ä¸ºä¸°å¯Œçš„ä¿¡æ¯é‡ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘æœ€å–œæ¬¢ä½¿ç”¨ç›´æ–¹å›¾çš„åŸå› ã€‚è¿™ç¯‡æ–‡ç« ä¸­æƒ³å†æ¬¡ä½¿ç”¨ggplot2å±•ç¤ºæˆ‘å·¥ä½œä¸­æœ€å¸¸ç”¨çš„ç›´æ–¹å›¾çš„ä½¿ç”¨ï¼Œç›´æ¥show codeå§ã€‚
</p>

<!--more-->

```{r fig.height=8, fig.width=12, message=FALSE, warning=FALSE}
# load packages
library(tidyverse)
library(rio)
library(ggsci)

# load data
data <- import("C:/Users/Dell/Desktop/test/ç›´æ–¹å›¾_test.xlsx")

# head data
head(data)
```

#### 1. å•å˜é‡ç›´æ–¹å›¾

```{r fig.height=8, fig.width=12, message=FALSE, warning=FALSE}
#å•å˜é‡ç›´æ–¹å›¾
# plot
data0 <- data %>%
  filter(å“ç§=="å“ç§2")
histgram_plot0 <- ggplot(data0, aes(x = æ€§çŠ¶2)) +
  geom_histogram(binwidth = 0.035, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
  scale_x_continuous(limits = c(1, 4),breaks = seq(1,4, 0.1))

# æ€»ä½“æ•°æ®ç»Ÿè®¡é‡
summ0 <- data0 %>%
  group_by(å“ç§) %>%
  rstatix::get_summary_stats(æ€§çŠ¶2, type = "common") %>%
  mutate_at(4:11, round, digits=2) %>%
  select(å“ç§, n, min, max, median, mean_all = mean, sd) %>%
  mutate(lab = paste("ç»Ÿè®¡:","\nn = ", n,"\nmin = ", min, "\nmax = ", max, "\nmedian = ", median, "\nmean = ", mean_all,"\nsd = ", sd),
         position=c(3.2)) %>%
  select(å“ç§, mean_all, lab, position)

# å°†ç»Ÿè®¡é‡å›¾å±‚æ·»åŠ åˆ°histgram_plotä¸­
histgram_plot0 + 
  geom_text(data = summ0, aes(x=position, label = lab), y=Inf, hjust=0, vjust=1.1, size=6, color = "black") +
  geom_vline(data = summ0, aes(xintercept = mean_all, color = breed), size=1, color = "red3") +
  theme_minimal() +
  labs(y = "è®¡æ•°",title = paste0("å“ç§2çš„æ€§çŠ¶2è¡¨å‹æƒ…å†µ"),x = "æ€§çŠ¶2") +
  theme(axis.title.x = element_text(vjust=0),
        axis.title.y = element_text(vjust=1),
        plot.title = element_text(color = "black", size = 22, face = "bold", vjust = 0.5, hjust = 0.5),
        strip.text = element_text(size = 15, face = "bold"),
        axis.title = element_text( size = 15, face = "bold" ),
        legend.position = "bottom"
  )
```

#### 2. å•å˜é‡åˆ†ç»„ç›´æ–¹å›¾

```{r fig.height=8, fig.width=12, message=FALSE, warning=FALSE}
# å•å˜é‡åˆ†ç»„ç›´æ–¹å›¾
# plot
histgram_plot <- ggplot(data, aes(x = æ€§çŠ¶2, fill = å“ç§)) +
  geom_histogram(binwidth = 0.035) +
  facet_grid(å“ç§ ~ ., scales = "fixed", space = "free") +
  scale_x_continuous(limits = c(1, 4),breaks = seq(1,4, 0.1)) +
  ggsci::scale_fill_aaas()

# æ€»ä½“æ•°æ®ç»Ÿè®¡é‡
summ1 <- data %>%
  group_by(å“ç§) %>%
  rstatix::get_summary_stats(æ€§çŠ¶2, type = "common") %>%
  mutate_at(4:11, round, digits=2) %>%
  select(å“ç§, n, min, max, median, mean_all = mean, sd) %>%
  mutate(lab = paste("ç»Ÿè®¡:","\nn = ", n,"\nmin = ", min, "\nmax = ", max, "\nmedian = ", median, "\nmean = ", mean_all,"\nsd = ", sd), position=c(3.2)) %>%
  select(å“ç§, mean_all, lab, position)

# å°†ç»Ÿè®¡é‡å›¾å±‚æ·»åŠ åˆ°histgram_plotä¸­
histgram_plot + 
  geom_text(data = summ1, aes(x=position, label = lab), y=Inf, hjust=0, vjust=1.1, size=5, color = "black") +
  geom_vline(data = summ1, aes(xintercept = mean_all, color = å“ç§), size=1, color = "green3") +
  theme_minimal() +
  labs(y = "è®¡æ•°",title = paste0("å“ç§1ä¸å“ç§2çš„æ€§çŠ¶2è¡¨å‹åˆ†å¸ƒæƒ…å†µ"),x = "æ€§çŠ¶2") +
  theme(axis.title.x = element_text(vjust=0),
        axis.title.y = element_text(vjust=1),
        plot.title = element_text(color = "black", size = 22, face = "bold", vjust = 0.5, hjust = 0.5),
        strip.text = element_text(size = 15, face = "bold"),
        axis.title = element_text( size = 15, face = "bold" ),
        legend.position = "bottom"
  )
```

#### 3. å¤šå˜é‡åˆ†ç»„ç›´æ–¹å›¾

```{r fig.height=8, fig.width=12, message=FALSE, warning=FALSE}
# å°†å®½æ ¼å¼æ•°æ®è½¬ä¸ºé•¿æ ¼å¼
data2 <- data %>%
  pivot_longer(æ€§çŠ¶1:æ€§çŠ¶2, names_to = "æ€§çŠ¶", values_to = "è¡¨å‹å€¼")

# head data2
head(data2)

```

```{r fig.height=8, fig.width=12, message=FALSE, warning=FALSE}
# å¤šå˜é‡åˆ†ç»„ç›´æ–¹å›¾
histgram_plot2 <- ggplot(data2, aes(x = è¡¨å‹å€¼, fill = å“ç§)) +
  geom_histogram(bins = 50) +
  facet_grid(å“ç§ ~ æ€§çŠ¶, scales = "free") +
  ggsci::scale_fill_aaas()

# æ€»ä½“æ•°æ®ç»Ÿè®¡é‡
summ2 <- data2 %>%
  group_by(å“ç§, æ€§çŠ¶) %>%
  rstatix::get_summary_stats(è¡¨å‹å€¼, type = "common") %>%
  mutate_at(4:11, round, digits=2) %>%
  select(å“ç§, æ€§çŠ¶, n, min, max, median, mean_all = mean, sd) %>%
  mutate(lab = paste("ç»Ÿè®¡:","\nn = ", n,"\nmin = ", min, "\nmax = ", max, "\nmedian = ", median, "\nmean = ", mean_all,"\nsd = ", sd), position=c(2.7)) %>%
  select(å“ç§, æ€§çŠ¶, mean_all, lab, position)

# å°†ç»Ÿè®¡é‡å›¾å±‚æ·»åŠ åˆ°histgram_plotä¸­
histgram_plot2 + 
  geom_text(data = summ2, aes(x=-Inf, y=Inf, label = lab), hjust=0, vjust=1.1, size=5, color = "purple", inherit.aes = FALSE) +
  geom_vline(data = summ2, aes(xintercept = mean_all, color = å“ç§), size=1, color = "green3") +
  theme_minimal()+
  labs(y = "è®¡æ•°",title = "å“ç§1å’Œå“ç§2çš„æ€§çŠ¶1å’Œæ€§çŠ¶2è¡¨å‹åˆ†å¸ƒæƒ…å†µ",x = "è¡¨å‹å€¼") +
  theme(axis.title.x = element_text(vjust=0),
        axis.title.y = element_text(vjust=1),
        plot.title = element_text(color = "black", size = 22, face = "bold", vjust = 0.5, hjust = 0.5),
        strip.text = element_text(size = 15, face = "bold"),
        axis.title = element_text( size = 15, face = "bold" ),
        legend.position = "bottom"
  )
```
